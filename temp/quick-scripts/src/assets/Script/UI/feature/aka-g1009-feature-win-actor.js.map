{"version":3,"sources":["assets/Script/UI/feature/aka-g1009-feature-win-actor.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import G1009Util from \"../../base/Util/aka-g1009-number-converter\";\nimport G1009GameController from \"../../base/controller/aka-g1009-game-controller\";\nimport { G1009EventManager } from \"../../base/events/aka-g1009-event-manager\";\nimport { G1009BalanceModel } from \"../../models/aka-g1009-balance-model\";\n\nconst { ccclass, property } = cc._decorator;\n\nconst COUNT_POINT_DURATION = 3;\n@ccclass\nexport default class G1009FeatureWinActor extends cc.Component {\n\n\t@property(cc.Node)\n\tcontent: cc.Node = null;\n\t@property(cc.Label)\n\tlblTotalWinPoint: cc.Label = null;\n\n\tprotected onLoad(): void {\n\t\tthis.reset();\n\t\tthis.register();\n\t}\n\n\tprivate register(): void {\n\t\tG1009EventManager.GetInstance().register(\"featureWinstarted\", this.onFeatureWinstarted.bind(this));\n\t}\n\n\tonFeatureWinstarted(): void {\n\t\tif (this.content != null) {\n\t\t\tthis.showTotalWin();\n\t\t}\n\t\telse {\n\t\t\tlet newBalance = G1009BalanceModel.GetInstance().GetBalance() + G1009GameController.GetInstance().GetTotalWinPoint();\n\t\t\tG1009BalanceModel.GetInstance().SetBalance(newBalance);\n\t\t\tG1009EventManager.GetInstance().notify(\"BalanceChange\", newBalance);\n\t\t\tG1009EventManager.GetInstance().notify(\"featureWinCompleted\");\n\t\t}\n\t}\n\n\tprivate showTotalWin(): void {\n\t\tlet totalWin = G1009GameController.GetInstance().GetTotalWinPoint();\n\t\tthis.content.active = true;\n\t\tcc.tween(this.content)\n\t\t\t.to(1, { opacity: 255 })\n\t\t\t.delay(COUNT_POINT_DURATION + 2)\n\t\t\t.call(() => {\n\t\t\t\tcc.tween(this.content)\n\t\t\t\t\t.to(1, { opacity: 0 }).call(() => {\n\t\t\t\t\t\tthis.reset();\n\t\t\t\t\t\tG1009EventManager.GetInstance().notify(\"featureWinCompleted\");\n\t\t\t\t\t})\n\t\t\t\t\t.start();\n\t\t\t}).start();\n\n\t\tlet objTween = {\n\t\t\tvalue: 0\n\t\t};\n\t\tcc.tween(objTween)\n\t\t\t.delay(1)\n\t\t\t.to(COUNT_POINT_DURATION, { value: totalWin }, {\n\t\t\t\tprogress: (start, end, current, ratio) => {\n\t\t\t\t\tthis.lblTotalWinPoint.string = G1009Util.Instance().NumberFormatWithoutCharacter(Math.round(current));\n\t\t\t\t\treturn start + (end - start) * ratio;\n\t\t\t\t}\n\t\t\t})\n\t\t\t.call(() => {\n\t\t\t\tthis.lblTotalWinPoint.string = G1009Util.Instance().NumberFormatWithoutCharacter(totalWin);\n\t\t\t\tlet newBalance = G1009BalanceModel.GetInstance().GetBalance() + G1009GameController.GetInstance().GetTotalWinPoint();\n\t\t\t\tG1009BalanceModel.GetInstance().SetBalance(newBalance);\n\t\t\t\tG1009EventManager.GetInstance().notify(\"BalanceChange\", newBalance);\n\t\t\t})\n\t\t\t.start();\n\t}\n\n\tprivate reset(): void {\n\t\tif(this.content!=null)\n\t\t{\n\t\t\tthis.lblTotalWinPoint.string = \"\";\n\t\t\tthis.content.active = false;\n\t\t\tthis.content.opacity = 0;\n\t\t}\n\t}\n}\n"]}