{"version":3,"sources":["assets/Script/base/sound/aka-g1009-sound-handler.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import G1009SoundConfig from \"../../config/sound-config\";\nimport { G1009EventManager } from \"../events/aka-g1009-event-manager\";\nimport G1009SoundControllerActor from \"../sound/aka-g1009-sound-controller\";\n\nconst {ccclass, property} = cc._decorator;\n\n@ccclass\nexport default class G1009SoundHandlerActor extends cc.Component {\n    \n    public soundController: G1009SoundControllerActor = null;\n    private spinItemCount: number = 0;\n    private landingCount: any = {};\n    private isFreeSpin: boolean = false;\n    private isStopImmediately: boolean = false;\n    private isPlayedSoundLandingImmediately: boolean = false;\n    private currentBGMMusicPlaying: string = \"\";\n    private tweenVolume: cc.Tween = cc.tween({});\n    SoundConfig: G1009SoundConfig = new G1009SoundConfig();\n\n    protected start(): void {\n        this.currentBGMMusicPlaying = this.SoundConfig.SoundNameConfig.BGMMainGame;\n        this.onPlayBGM(this.SoundConfig.SoundNameConfig.BGMMainGame);      \n        this.spinItemCount = 0;\n        this.landingCount = {};\n        this.isFreeSpin = false;\n        this.isStopImmediately = false;\n        this.isPlayedSoundLandingImmediately = false;\n        this.tweenVolume = cc.tween({});\n    }\n    \n    protected onLoad(): void {\n        this.soundController = G1009SoundControllerActor.Instance;\n        this.register();\n    }\n    private register(): void {\n        G1009EventManager.GetInstance().register(\"PlaySFX\", this.onPlaySFX.bind(this));\n        G1009EventManager.GetInstance().register(\"StopSFX\", this.onStopSFX.bind(this));\n        G1009EventManager.GetInstance().register(\"PlayBGM\", this.onPlayBGM.bind(this));\n        G1009EventManager.GetInstance().register(\"StopBGM\", this.onStopBGM.bind(this));\n        G1009EventManager.GetInstance().register(\"ShowBetPanel\", this.onPlayMainGameBGMusic.bind(this));\n        G1009EventManager.GetInstance().register(\"BonusWinStarted\", this.onPlayBonusGameBGMusic.bind(this));\n        G1009EventManager.GetInstance().register(\"EnterFreespins\", this.onPlayFreeGameBGMusic.bind(this));\n        G1009EventManager.GetInstance().register(\"JackpotStarted\", this.onPlayJackPotBGMusic.bind(this));\n        G1009EventManager.GetInstance().register(\"BigWinStarted\", this.onPlayBigWinBGMusic.bind(this));\n        G1009EventManager.GetInstance().register(\"FeatureTrigger\", this.onFeatureTrigger.bind(this));\n\t\n    }\n\n    private onFeatureTrigger(): void{\n       // this.onPlaySFX({ sfxName: \"sfx_featurewin\", isLoop: false });\n    }\n\n    private onPlayMainGameBGMusic(): void{\n        if (this.currentBGMMusicPlaying != this.SoundConfig.SoundNameConfig.BGMMainGame)\n        {          \n            this.onPlayBGM(this.SoundConfig.SoundNameConfig.BGMMainGame);\n        }\n    }\n\n    private onPlayFreeGameBGMusic(): void{\n        if (this.currentBGMMusicPlaying != this.SoundConfig.SoundNameConfig.BGMFreeGame)\n        { \n            this.onPlayBGM(this.SoundConfig.SoundNameConfig.BGMFreeGame);\n        }\n    }\n\n    private onPlayBonusGameBGMusic(): void{\n        if (this.currentBGMMusicPlaying != this.SoundConfig.SoundNameConfig.BGMBonusGame)\n        {          \n            this.onPlayBGM(this.SoundConfig.SoundNameConfig.BGMBonusGame);\n        }\n    }\n\n    private onPlayJackPotBGMusic(): void{\n        if (this.currentBGMMusicPlaying != this.SoundConfig.SoundNameConfig.BGMJackPot)\n        {           \n            this.onPlayBGM(this.SoundConfig.SoundNameConfig.BGMJackPot);\n        }\n    }\n\n    private onPlayBigWinBGMusic(): void{\n        if (this.currentBGMMusicPlaying != this.SoundConfig.SoundNameConfig.BGMBigWin)\n        {\n          \n            this.onPlayBGM(this.SoundConfig.SoundNameConfig.BGMBigWin);\n        }\n    }\n    \n    private onPlayBGM(bgmName: string) {\n        this.onStopBGM(this.currentBGMMusicPlaying);\n        if (this.SoundConfig.SoundVolume.hasOwnProperty(bgmName))\n            this.soundController.SetMusicVolume(this.SoundConfig.SoundVolume[bgmName]);\n            this.currentBGMMusicPlaying = bgmName;\n        this.soundController.PlayMusic(bgmName);\n    }\n\n    private onStopBGM(bgmName:string)\n    {\n        this.soundController.StopMusic(bgmName);\n    }\n\n    private onPlaySFX(data: { sfxName: string, isLoop: boolean })\n    {\n        this.handleEventPlaySfx(data.sfxName, data.isLoop === true);\n    }\n\n    private onStopSFX(data: { sfxName: string, fadingTime: number })\n    {\n        this.handleEventStopSfx(data.sfxName, data.fadingTime);;\n    }\n\n    public reduceVolume() {\n    \n        this.tweenVolume.stop();\n        this.tweenVolume = cc.tween({});\n        let vol = this.getMusicVolume() - this.SoundConfig.SoundVolumeReduction;\n        this.soundController.SetMusicVolume(vol);\n    }\n\n    public restoreVolume() {\n        \n        this.tweenVolume.stop();\n        this.tweenVolume = cc.tween({});\n        let currValue = this.soundController.GetMusicVolume();\n        let desValue = this.getMusicVolume();\n        let objectValues = { value: currValue };\n        cc.tween(objectValues).to(0.25, { value: desValue }, {\n            progress: (start, end, current, ratio) => {\n                this.soundController.SetMusicVolume(current);\n            }\n        }).start();\n    }\n       \n    public getMusicVolume() {\n       \n        return this.SoundConfig.SoundVolume[  this.currentBGMMusicPlaying]\n    }\n\n    public  handleEventPlaySfx(soundName:string, isLoop:boolean) {\n       \n        this.soundController.PlaySfx(soundName, isLoop === true);\n    }\n\n    public  handleEventStopSfx(soundName:string, fadingTime:number) {\n            \n        if (fadingTime > 0) {\n            this.soundController.StopSfxWithFadeOut(soundName, fadingTime);\n        } else {\n            this.soundController.StopSfx(soundName);\n        }\n    }\n\n}\n"]}