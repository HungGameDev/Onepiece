{"version":3,"sources":["assets\\Script\\avenger-game\\exploding-panel\\avenger-exploding-panel.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AACA,+EAA2E;AAC3E,qEAA8D;AAC9D,mEAAqD;AAE/C,IAAA,KAAwB,EAAE,CAAC,UAAU,EAAnC,OAAO,aAAA,EAAE,QAAQ,cAAkB,CAAC;AAG5C;IAA4C,kCAAY;IAAxD;QAAA,qEAmDC;QAhDG,eAAS,GAAsB,EAAE,CAAC;QAGlC,oBAAc,GAAoB,EAAE,CAAC;QAE7B,yBAAmB,GAAG,KAAK,CAAC;QAC5B,cAAQ,GAAa,IAAI,CAAC;;IA0CtC,CAAC;IAxCW,iCAAQ,GAAhB;QACI,wCAAiB,CAAC,WAAW,EAAE,CAAC,QAAQ,CAAC,sBAAsB,EAAE,IAAI,CAAC,sBAAsB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;QACzG,wCAAiB,CAAC,WAAW,EAAE,CAAC,QAAQ,CAAC,aAAa,EAAE,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;IAE3F,CAAC;IAED,+BAAM,GAAN;QAAA,iBAKC;QAJG,IAAI,CAAC,QAAQ,EAAE,CAAC;QAChB,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,UAAA,QAAQ;YAC3B,QAAQ,CAAC,kBAAkB,GAAG,KAAI,CAAC,sBAAsB,CAAC,IAAI,CAAC,KAAI,CAAC,CAAC;QACzE,CAAC,CAAC,CAAC;IACP,CAAC;IAEO,sCAAa,GAArB,UAAsB,KAAK;QACvB,IAAI,CAAC,QAAQ,GAAG,KAAK,CAAC;IAC1B,CAAC;IAEO,+CAAsB,GAA9B,UAA+B,SAAS;QACpC,IAAI,CAAC,mBAAmB,GAAG,IAAI,CAAC;QAChC,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,UAAA,QAAQ;YAC3B,QAAQ,CAAC,iBAAiB,CAAC,SAAS,CAAC,aAAa,EAAE,SAAS,CAAC,KAAK,CAAC,CAAC;QACzE,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC,sBAAsB,CAAC,SAAS,CAAC,CAAC;IAC3C,CAAC;IAEO,+CAAsB,GAA9B,UAA+B,SAAc;QAA7C,iBAMC;QALG,SAAS,CAAC,aAAa,CAAC,OAAO,CAAC,UAAA,cAAc;YAC1C,IAAI,UAAU,GAAG,KAAI,CAAC,QAAQ,CAAC,cAAc,CAAC,CAAC;YAC/C,KAAI,CAAC,cAAc,CAAC,cAAc,CAAC,CAAC,sBAAsB,CAAC,UAAU,CAAC,CAAC;QAC3E,CAAC,CAAC,CAAC;QACH,IAAI,CAAC,QAAQ,GAAG,SAAS,CAAC,KAAK,CAAC;IACpC,CAAC;IAEO,+CAAsB,GAA9B;QACI,IAAI,IAAI,CAAC,mBAAmB,EAAE;YAC1B,IAAI,CAAC,mBAAmB,GAAG,KAAK,CAAC;YACjC,wCAAiB,CAAC,WAAW,EAAE,CAAC,MAAM,CAAC,sBAAsB,CAAC,CAAC;SAClE;IACL,CAAC;IA/CD;QADC,QAAQ,CAAC,2BAAe,CAAC;qDACQ;IAGlC;QADC,QAAQ,CAAC,gCAAa,CAAC;0DACa;IANpB,cAAc;QADlC,OAAO;OACa,cAAc,CAmDlC;IAAD,qBAAC;CAnDD,AAmDC,CAnD2C,EAAE,CAAC,SAAS,GAmDvD;kBAnDoB,cAAc","file":"","sourceRoot":"/","sourcesContent":["import { G1009AnimationProviderManager } from \"../../base/animation/Slot45-animation-provider\";\r\nimport { G1009EventManager } from \"../../base/events/Slot45-event-manager\";\r\nimport AvengerSpinItem from \"../spin-panel/avenger-spin-item\";\r\nimport ExplodingCell from \"./avenger-exploding-cell\";\r\n\r\nconst { ccclass, property } = cc._decorator;\r\n\r\n@ccclass\r\nexport default class ExplodingPanel extends cc.Component {\r\n\r\n    @property(AvengerSpinItem)\r\n    spinItems: AvengerSpinItem[] = [];\r\n\r\n    @property(ExplodingCell)\r\n    ExplodingCells: ExplodingCell[] = [];\r\n\r\n    private isStartExplodeCells = false;\r\n    private oldCells: string[] = null;\r\n\r\n    private register(): void {\r\n        G1009EventManager.GetInstance().register(\"StartPresentWinCombo\", this.onStartPresentWinCombo.bind(this));\r\n        G1009EventManager.GetInstance().register(\"DataRespond\", this.onDataRespond.bind(this));\r\n\r\n    }\r\n\r\n    onLoad() {\r\n        this.register();\r\n        this.spinItems.forEach(spinItem => {\r\n            spinItem.onExplodeCompleted = this.handleExplodeCompleted.bind(this);\r\n        });\r\n    }\r\n\r\n    private onDataRespond(cells) {\r\n        this.oldCells = cells;\r\n    }\r\n\r\n    private onStartPresentWinCombo(comboData) {\r\n        this.isStartExplodeCells = true;\r\n        this.spinItems.forEach(spinItem => {\r\n            spinItem.StartExplodeCells(comboData.explodedCells, comboData.Cells);\r\n        });\r\n\r\n        this.playEffectExplodeCells(comboData);\r\n    }\r\n\r\n    private playEffectExplodeCells(comboData: any) {\r\n        comboData.explodedCells.forEach(idExplodedCell => {\r\n            var nameSymbol = this.oldCells[idExplodedCell];\r\n            this.ExplodingCells[idExplodedCell].PlayEffectExplodeCells(nameSymbol);\r\n        });\r\n        this.oldCells = comboData.Cells;\r\n    }\r\n\r\n    private handleExplodeCompleted() {\r\n        if (this.isStartExplodeCells) {\r\n            this.isStartExplodeCells = false;\r\n            G1009EventManager.GetInstance().notify(\"ExplodeCellsComplete\");\r\n        }\r\n    }\r\n}\r\n"]}