{"version":3,"sources":["assets\\Script\\UI\\feature\\Slot45-feature-win-actor.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import G1009Util from \"../../base/Util/Slot45-number-converter\";\r\nimport G1009GameController from \"../../base/controller/Slot45-game-controller\";\r\nimport { G1009EventManager } from \"../../base/events/Slot45-event-manager\";\r\nimport { G1009BalanceModel } from \"../../models/Slot45-balance-model\";\r\n\r\nconst { ccclass, property } = cc._decorator;\r\n\r\nconst COUNT_POINT_DURATION = 3;\r\n@ccclass\r\nexport default class G1009FeatureWinActor extends cc.Component {\r\n\r\n\t@property(cc.Node)\r\n\tcontent: cc.Node = null;\r\n\t@property(cc.Label)\r\n\tlblTotalWinPoint: cc.Label = null;\r\n\r\n\tprotected onLoad(): void {\r\n\t\tthis.reset();\r\n\t\tthis.register();\r\n\t}\r\n\r\n\tprivate register(): void {\r\n\t\tG1009EventManager.GetInstance().register(\"featureWinstarted\", this.onFeatureWinstarted.bind(this));\r\n\t}\r\n\r\n\tonFeatureWinstarted(): void {\r\n\t\tif (this.content != null) {\r\n\t\t\tthis.showTotalWin();\r\n\t\t}\r\n\t\telse {\r\n\t\t\tlet newBalance = G1009BalanceModel.GetInstance().GetBalance() + G1009GameController.GetInstance().GetTotalWinPoint();\r\n\t\t\tG1009BalanceModel.GetInstance().SetBalance(newBalance);\r\n\t\t\tG1009EventManager.GetInstance().notify(\"BalanceChange\", newBalance);\r\n\t\t\tG1009EventManager.GetInstance().notify(\"featureWinCompleted\");\r\n\t\t}\r\n\t}\r\n\r\n\tprivate showTotalWin(): void {\r\n\t\tlet totalWin = G1009GameController.GetInstance().GetTotalWinPoint();\r\n\t\tthis.content.active = true;\r\n\t\tcc.tween(this.content)\r\n\t\t\t.to(1, { opacity: 255 })\r\n\t\t\t.delay(COUNT_POINT_DURATION + 2)\r\n\t\t\t.call(() => {\r\n\t\t\t\tcc.tween(this.content)\r\n\t\t\t\t\t.to(1, { opacity: 0 }).call(() => {\r\n\t\t\t\t\t\tthis.reset();\r\n\t\t\t\t\t\tG1009EventManager.GetInstance().notify(\"featureWinCompleted\");\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.start();\r\n\t\t\t}).start();\r\n\r\n\t\tlet objTween = {\r\n\t\t\tvalue: 0\r\n\t\t};\r\n\t\tcc.tween(objTween)\r\n\t\t\t.delay(1)\r\n\t\t\t.to(COUNT_POINT_DURATION, { value: totalWin }, {\r\n\t\t\t\tprogress: (start, end, current, ratio) => {\r\n\t\t\t\t\tthis.lblTotalWinPoint.string = G1009Util.Instance().NumberFormatWithoutCharacter(Math.round(current));\r\n\t\t\t\t\treturn start + (end - start) * ratio;\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\t.call(() => {\r\n\t\t\t\tthis.lblTotalWinPoint.string = G1009Util.Instance().NumberFormatWithoutCharacter(totalWin);\r\n\t\t\t\tlet newBalance = G1009BalanceModel.GetInstance().GetBalance() + G1009GameController.GetInstance().GetTotalWinPoint();\r\n\t\t\t\tG1009BalanceModel.GetInstance().SetBalance(newBalance);\r\n\t\t\t\tG1009EventManager.GetInstance().notify(\"BalanceChange\", newBalance);\r\n\t\t\t})\r\n\t\t\t.start();\r\n\t}\r\n\r\n\tprivate reset(): void {\r\n\t\tif(this.content!=null)\r\n\t\t{\r\n\t\t\tthis.lblTotalWinPoint.string = \"\";\r\n\t\t\tthis.content.active = false;\r\n\t\t\tthis.content.opacity = 0;\r\n\t\t}\r\n\t}\r\n}\r\n"]}