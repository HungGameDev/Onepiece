{"version":3,"sources":["assets\\Script\\base\\sound\\Slot45-sound-handler.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import Slot45SoundConfig from \"../../config/sound-config\";\r\nimport { Slot45EventManager } from \"../events/Slot45-event-manager\";\r\nimport Slot45SoundControllerActor from \"./Slot45-sound-controller\";\r\n\r\nconst {ccclass, property} = cc._decorator;\r\n\r\n@ccclass\r\nexport default class Slot45SoundHandlerActor extends cc.Component {\r\n    \r\n    public soundController: Slot45SoundControllerActor = null;\r\n    private spinItemCount: number = 0;\r\n    private landingCount: any = {};\r\n    private isFreeSpin: boolean = false;\r\n    private isStopImmediately: boolean = false;\r\n    private isPlayedSoundLandingImmediately: boolean = false;\r\n    private currentBGMMusicPlaying: string = \"\";\r\n    private tweenVolume: cc.Tween = cc.tween({});\r\n    SoundConfig: Slot45SoundConfig = new Slot45SoundConfig();\r\n\r\n    protected start(): void {\r\n        this.currentBGMMusicPlaying = this.SoundConfig.SoundNameConfig.BGMChooseBet;\r\n        this.onPlayBGM(this.SoundConfig.SoundNameConfig.BGMChooseBet);      \r\n        this.spinItemCount = 0;\r\n        this.landingCount = {};\r\n        this.isFreeSpin = false;\r\n        this.isStopImmediately = false;\r\n        this.isPlayedSoundLandingImmediately = false;\r\n        this.tweenVolume = cc.tween({});\r\n    }\r\n    \r\n    protected onLoad(): void {\r\n        this.soundController = Slot45SoundControllerActor.Instance;\r\n        this.register();\r\n    }\r\n    private register(): void {\r\n        Slot45EventManager.GetInstance().register(\"PlaySFX\", this.onPlaySFX.bind(this));\r\n        Slot45EventManager.GetInstance().register(\"StopSFX\", this.onStopSFX.bind(this));\r\n        Slot45EventManager.GetInstance().register(\"PlayBGM\", this.onPlayBGM.bind(this));\r\n        Slot45EventManager.GetInstance().register(\"StopBGM\", this.onStopBGM.bind(this));\r\n        Slot45EventManager.GetInstance().register(\"ShowPopupChangeBet\", this.onPlayChooseBetBGMusic.bind(this));\r\n        Slot45EventManager.GetInstance().register(\"ChangeBet\", this.onPlayMainGameBGMusic.bind(this));\r\n        Slot45EventManager.GetInstance().register(\"FeatureTrigger\", this.onFeatureTrigger.bind(this));\r\n\t\r\n    }\r\n\r\n    private onFeatureTrigger(): void{\r\n       // this.onPlaySFX({ sfxName: \"sfx_featurewin\", isLoop: false });\r\n    }\r\n\r\n    private onPlayChooseBetBGMusic(): void{\r\n        if (this.currentBGMMusicPlaying != this.SoundConfig.SoundNameConfig.BGMChooseBet)\r\n        {          \r\n            this.onPlayBGM(this.SoundConfig.SoundNameConfig.BGMChooseBet);\r\n        }\r\n    }\r\n\r\n    private onPlayMainGameBGMusic(): void{\r\n        if (this.currentBGMMusicPlaying != this.SoundConfig.SoundNameConfig.BGMMainGame)\r\n        {          \r\n            this.onPlayBGM(this.SoundConfig.SoundNameConfig.BGMMainGame);\r\n        }\r\n    }\r\n    \r\n    private onPlayBGM(bgmName: string) {\r\n        this.onStopBGM(this.currentBGMMusicPlaying);\r\n        if (this.SoundConfig.SoundVolume.hasOwnProperty(bgmName))\r\n            this.soundController.SetMusicVolume(this.SoundConfig.SoundVolume[bgmName]);\r\n            this.currentBGMMusicPlaying = bgmName;\r\n        this.soundController.PlayMusic(bgmName);\r\n    }\r\n\r\n    private onStopBGM(bgmName:string)\r\n    {\r\n        this.soundController.StopMusic(bgmName);\r\n    }\r\n\r\n    private onPlaySFX(data: { sfxName: string, isLoop: boolean })\r\n    {\r\n        this.handleEventPlaySfx(data.sfxName, data.isLoop === true);\r\n    }\r\n\r\n    private onStopSFX(data: { sfxName: string, fadingTime: number })\r\n    {\r\n        this.handleEventStopSfx(data.sfxName, data.fadingTime);;\r\n    }\r\n\r\n    public reduceVolume() {\r\n    \r\n        this.tweenVolume.stop();\r\n        this.tweenVolume = cc.tween({});\r\n        let vol = this.getMusicVolume() - this.SoundConfig.SoundVolumeReduction;\r\n        this.soundController.SetMusicVolume(vol);\r\n    }\r\n\r\n    public restoreVolume() {\r\n        \r\n        this.tweenVolume.stop();\r\n        this.tweenVolume = cc.tween({});\r\n        let currValue = this.soundController.GetMusicVolume();\r\n        let desValue = this.getMusicVolume();\r\n        let objectValues = { value: currValue };\r\n        cc.tween(objectValues).to(0.25, { value: desValue }, {\r\n            progress: (start, end, current, ratio) => {\r\n                this.soundController.SetMusicVolume(current);\r\n            }\r\n        }).start();\r\n    }\r\n       \r\n    public getMusicVolume() {\r\n       \r\n        return this.SoundConfig.SoundVolume[  this.currentBGMMusicPlaying]\r\n    }\r\n\r\n    public  handleEventPlaySfx(soundName:string, isLoop:boolean) {\r\n       \r\n        this.soundController.PlaySfx(soundName, isLoop === true);\r\n    }\r\n\r\n    public  handleEventStopSfx(soundName:string, fadingTime:number) {\r\n            \r\n        if (fadingTime > 0) {\r\n            this.soundController.StopSfxWithFadeOut(soundName, fadingTime);\r\n        } else {\r\n            this.soundController.StopSfx(soundName);\r\n        }\r\n    }\r\n\r\n}\r\n"]}