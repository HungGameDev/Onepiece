{"version":3,"sources":["assets/Script/base/sound/aka-g1009-music-player.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import G1009SoundPlayerActor from \"./aka-g1009-sound-player\";\n\nconst {ccclass, property} = cc._decorator;\n\n@ccclass\nexport default class G1009MusicPlayerActor extends G1009SoundPlayerActor {\n\n    isMute: boolean = false;\n    muteVolume: number = 1;\n    audioPlayingName: string = \"\";\n    audioPlayingID: number = -1;\n    tweenFadeOut: cc.Tween = cc.tween();\n   \n    private handleAudioClipLoaded(audioID: number, audioName: string, isLoop: boolean) {\n        \n        let startLoadTime = Date.now();\n        this.audioClips[audioName].once(\"load\", function () {\n            if (this.audioPlayingName != audioName)\n            {\n                cc.audioEngine.stopEffect(audioID);\n                return;\n            }\n\n            let totalLoadTime = (Date.now() - startLoadTime) / 1000;\n            if (totalLoadTime > this.GetAudioDuration(audioName) && isLoop == false)\n            {\n                this.Stop(audioName);\n            }\n            else\n            {\n                let audioCurrentTime = totalLoadTime % this.GetAudioDuration(audioName);\n                cc.audioEngine.setCurrentTime(audioID, audioCurrentTime);\n            }\n        });\n    }\n    \n    public Play(audioName: string, isLoop: boolean) {\n       \n        if (this.audioClips[audioName] != null)\n        {\n            let audioID = cc.audioEngine.playMusic(this.audioClips[audioName], isLoop);\n            this.audioPlayingName = audioName;\n            this.audioPlayingID = audioID;\n\n            if (!this.audioClips[audioName].loaded)\n            {\n                this.handleAudioClipLoaded(audioID, audioName, isLoop);\n            }\n        }\n    }\n\n    public Stop(audioName: string) {\n\n        audioName = audioName || this.audioPlayingName;\n        if (audioName != this.audioPlayingName)\n        {\n            return;\n        }\n        this.tweenFadeOut.stop();\n        cc.audioEngine.stopMusic();\n        this.audioPlayingName = \"\";\n    }\n    public StopWithFadeOut(audioName: string, duration: number) {\n   \n        if (arguments[1] == null)\n        {\n            duration = arguments[0];\n            audioName = this.audioPlayingName;\n        }\n        else if (audioName !== this.audioPlayingName)\n        {\n            return;\n        }\n\n        let saveVolume = cc.audioEngine.getVolume(this.audioPlayingID);\n        let obj = {\n            _volume: saveVolume,\n            get volume() {\n                return this._volume\n            },\n            set volume(val) {\n                this._volume = val;\n                cc.audioEngine.setVolume(this.audioPlayingID, this._volume);\n            }\n        };\n        this.tweenFadeOut.stop()\n        this.tweenFadeOut = cc.tween(obj);\n        this.tweenFadeOut.to(duration, { volume: 0 });\n        this.tweenFadeOut.call(() => {\n            cc.audioEngine.setVolume(this.audioPlayingID, saveVolume);\n            this.Stop(audioName);\n        });\n        this.tweenFadeOut.start();\n    }\n\n    public Mute() {\n    \n        if (this.isMute == false)\n        {\n            this.isMute = true;\n            this.muteVolume = cc.audioEngine.getMusicVolume();\n            cc.audioEngine.setMusicVolume(0);\n        }\n    }\n\n    public Unmute() {\n    \n        if (this.isMute)\n        {\n            this.isMute = false;\n            cc.audioEngine.setMusicVolume(this.muteVolume);\n        }\n    }\n\n    public IsMute() {\n     \n        return this.isMute;\n    }\n\n    public SetVolume(volume: number) {\n      \n        if (this.isMute)\n        {\n            this.muteVolume = volume;\n        }\n        else\n        {\n            cc.audioEngine.setMusicVolume(volume);\n        }\n    }\n\n    public GetVolume() {\n   \n        if (this.isMute)\n        {\n            return this.muteVolume;\n        }\n        else\n        {\n            return cc.audioEngine.getMusicVolume();\n        }\n    }\n\n    public GetAudioDuration(audioName: string) {\n     \n        if (this.audioClips[audioName] != null)\n        {\n            return this.audioClips[audioName]._audio ? this.audioClips[audioName]._audio.duration : 0;\n        }\n    }\n\n    public GetAudioPlaying() {\n      \n        return this.audioPlayingName;\n    }\n}\n"]}